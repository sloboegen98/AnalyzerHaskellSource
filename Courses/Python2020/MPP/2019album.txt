[docx] +'Album2019.docx'
[docx] LANDSCAPE # Альбомная ориентация

[docx] +h 'My-Album'

'https://ru.wikipedia.org/wiki/%D0%A8%D0%B0%D0%B1%D0%BB%D0%BE%D0%BD:Potd/2019-01'

[docx] +sh 'January'

forall
    [docx] +p Full

[docx] +A4

'https://ru.wikipedia.org/wiki/%D0%A8%D0%B0%D0%B1%D0%BB%D0%BE%D0%BD:Potd/2019-02'

[docx] +sh 'Февраль'

forall
    [docx] +p Full

[docx] +A4

'https://ru.wikipedia.org/wiki/%D0%A8%D0%B0%D0%B1%D0%BB%D0%BE%D0%BD:Potd/2019-03'

[docx] +sh 'Март'

forall (0, 31)
    [docx] +p Full

[docx] +A4

'https://ru.wikipedia.org/wiki/%D0%A8%D0%B0%D0%B1%D0%BB%D0%BE%D0%BD:Potd/2019-04'

[docx] +sh 'AAAAApril'

[docx] +p Full

forall (1,30)
    [docx] +p Full

[docx] +A4

'https://ru.wikipedia.org/wiki/%D0%A8%D0%B0%D0%B1%D0%BB%D0%BE%D0%BD:Potd/2019-05'

[docx] +sh 'May'

forall
    [docx] +p Full

[docx] +A4

'https://ru.wikipedia.org/wiki/%D0%A8%D0%B0%D0%B1%D0%BB%D0%BE%D0%BD:Potd/2019-06'

[docx] +sh 'June'
[docx] +t 'Хоп, а вот и текст'

forall
    [docx] +p Full

[docx] +A4

'https://ru.wikipedia.org/wiki/%D0%A8%D0%B0%D0%B1%D0%BB%D0%BE%D0%BD:Potd/2019-07'

[docx] +sh 'July'

forall
    [docx] +p Full
    
[docx] +A4

'https://ru.wikipedia.org/wiki/%D0%A8%D0%B0%D0%B1%D0%BB%D0%BE%D0%BD:Potd/2019-08'

[docx] +sh 'August'

forall
    [docx] +p Full

[docx] +A4

'https://ru.wikipedia.org/wiki/%D0%A8%D0%B0%D0%B1%D0%BB%D0%BE%D0%BD:Potd/2019-09'

[docx] +sh 'Сентябрь........'

forall
    [docx] +p Full

[docx] +A4

'https://ru.wikipedia.org/wiki/%D0%A8%D0%B0%D0%B1%D0%BB%D0%BE%D0%BD:Potd/2019-10'

[docx] +sh 'Окт'

forall
    [docx] +p Full

[docx] +A4

'https://ru.wikipedia.org/wiki/%D0%A8%D0%B0%D0%B1%D0%BB%D0%BE%D0%BD:Potd/2019-11'

[docx] +sh 'Nov'

forall
    [docx] +p Full

[docx] +A4

'https://ru.wikipedia.org/wiki/%D0%A8%D0%B0%D0%B1%D0%BB%D0%BE%D0%BD:Potd/2019-12'

[docx] +sh '12'

forall
    [docx] +p Full
В общем, сделал совсем простенький язычок: переменных нет, циклы только по содержимому(картинка + текст), вложенные нельзя.
Не стал нигде использовать xpath выражения, так как цель все равно одна - скачать текст и картинки с определенного сайта. Может быть, слишком упростил...

По поводу картинок: не знаю почему, но некоторые не загружались. Локально скачивать и удалять я не хотел, поэтому просто как BytesIO передавал со страницы. Причем, если выставлять, например, '400px' в ссылке, то картинка скачивается, а другая - не скачивается, но под '800px' уже скачивается, а третья - под '399px'... 

(пример ссылки:  https://upload.wikimedia.org/wikipedia/commons/thumb/1/16/2016_Konica_Auto_S3_1.jpg/624px-2016_Konica_Auto_S3_1.jpg).

Если скачивать оригинал, то дело обстоит лучше, но, конечный файл весит 5 Гб и 2 часа скачивается, тоже ерунда какая-то. В общем, я решил, что не сильно страшно, и оставил скачивание '400px', а если не удалось, то пытаюсь скачать '800px', если и так не удалось, то остаемся без картинки.

Так, теперь, что есть. Сделал возможность в цикле выбирать диапазон(как в питоне). У пользователя есть возможность выбирать, что вставлять: текст, либо фотку, либо все сразу. Можно писать:
```
[docx] +p Full
[docx] +p Full
[docx] +p Full
```

Тогда вставится первое, второе, третье фото с текстом. Что-то наподобие генератора.

Ну и можно просто писать:
```
[docx] +p 1 Full
```
Тогда он вставит вторую картинку(нумерация с нуля).

Перейдем к тому, как это устроено внутри. Есть модули utils и parser. 

utils это как раз про веб и docx. parser сделал на ANTLR (сгенеренные файлы не стал удалять, чтобы если что не приходилось ставить antlr, а только питоновский рантайм). Интересный момент: ANTLR умеет лишь работать с LL грамматиками, но в нашем языке есть отступы, как в питоне, мы тогда просто на стадии лексического анализа, вставим открывающие/закрывающие скобки, разделители там где надо. И вот, у нас получилась программа, которую мы можем пропарсить LL парсером.

Далее, основной файл это runner.py. Он получает AST от парсера, и дальше по нему ходит и сразу запускает нужные функции из utils. Вообще писал сначала трансляцию в некое промежуточное представление, но как только прочитал ваш комментарий про то, что дзен компиляторов в этой домашке постигать не надо, то перестал этим заниматься, и сделал все попроще:)

Впечатления: очень прикольное задание, мне как раз очень нравится теория языков программирования, так что удовольствия море было. Конечно, меня прямо изнутри разрывает, что не сделал нормальные циклы, но вроде не так страшно.